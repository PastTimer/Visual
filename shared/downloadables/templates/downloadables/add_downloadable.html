{% extends "base_internal.html" %}
{% block content %}

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Add Downloadable</title>

<link href="https://fonts.googleapis.com/css2?family=Instrument+Sans:700&family=Inter:wght@400;500;700&display=swap" rel="stylesheet">

<style>
    body {
        background: #F9F9F9;
        margin: 0;
        font-family: 'Inter', Arial, sans-serif;
    }

    .main-container {
        margin: 60px;
        display: flex;
        flex-direction: column;
        gap: 30px;
    }

	.form-title {
		font-family: 'Inter', Arial, sans-serif;
        font-weight: 400;
        font-size: 32px;
		margin: 0;
		color: #000000;
	}

    .downloadable-form {
        display: flex;
        flex-direction: column;
        gap: 20px;
    }

	.form-group {
		display: flex;
		align-items: flex-start;
		gap: 1rem;
	}

	.form-label {
		font-weight: 600;
		color: #374151;
		padding-top: 0.75rem;
		font-size: 0.95rem;
	}

	.upload-area {
		flex: 1;
		border: 2px dashed #E5E7EB;
		border-radius: 8px;
		padding: 2rem;
		text-align: center;
		background: #F9F9F9;
		cursor: pointer;
		transition: all 0.2s ease;
		display: flex;
		flex-direction: column;
		align-items: center;
		gap: 0.5rem;
	}

    .upload-area:hover {
        border-color: #0A6C44;
        background: #F0FDF4;
    }

    .upload-icon {
        width: 24px;
        height: 24px;
        color: #4B5563;
    }

    .upload-text {
        color: #4B5563;
        font-size: 0.95rem;
    }

    .file-preview {
        margin-top: 1rem;
        padding: 1rem;
        background: #F0FDF4;
        border: 1px solid #BBF7D0;
        border-radius: 8px;
        display: none;
    }

    .file-info {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        color: #1f7c57;
        font-size: 0.95rem;
    }

    .checkbox-row {
        display: flex;
        align-items: center;
        gap: 10px;
        align-self: flex-start;
        margin-top: 0.5rem;
    }

	.form-actions {
		display: flex;
		gap: 1rem;
		justify-content: flex-end;
		margin-top: 2rem;
		padding-top: 1.5rem;
		border-top: 1px solid #E5E7EB;
	}

    .back-btn {
        padding: 0.75rem 1.5rem;
        border: none;
        border-radius: 8px;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s ease;
        font-family: 'Inter', sans-serif;
		background: #6B7280;
		color: white;
        text-decoration: none;
    }

    .back-btn:hover {
		background: #4B5563;
		transform: translateY(-1px);
    }
    
    .submit-btn {
		padding: 0.75rem 1.5rem;
		border: none;
		border-radius: 8px;
		font-size: 1rem;
		font-weight: 600;
		cursor: pointer;
		transition: all 0.2s ease;
		font-family: 'Inter', sans-serif;
		background: #0A6C44;
		color: white;
    }

    .submit-btn:hover {
        background: #1f7c57;
		transform: translateY(-1px);
    }

    .success-message {
        color: #10B981;
        font-size: 1rem;
        margin-bottom: 1rem;
        text-align: center;
    }

    .error-message {
        color: #E53E3E;
        font-size: 1rem;
        margin-bottom: 1rem;
        text-align: center;
    }
</style>

</head>
<body>
    <div class="main-container">
        <h1 class="form-title">Add Downloadable</h1>

        {% if success %}
            <div class="success-message">Downloadable added successfully!</div>
        {% endif %}
        {% if error %}
            <div class="error-message">{{ error }}</div>
        {% endif %}

        <form class="downloadable-form" method="post" enctype="multipart/form-data" id="downloadable-form" action="{% url 'add_downloadable' %}">
            {% csrf_token %}
            <div class="form-group">
                <label class="form-label" for="id_file">Attach File:</label>
                <div class="upload-area" onclick="document.getElementById('id_file').click()">
                    <svg class="upload-icon"><use href="#icon-upload"></use></svg>
                    <span class="upload-text">Click to upload</span>
                    <input class="file-input" type="file" name="file" id="id_file" style="display:none;" accept="*/*" required>
                </div>
                <div id="file-error" class="error-message" style="display:none;">File is required.</div>
            </div>
            <div class="file-preview" id="file-preview">
                <div class="file-info">
                    <svg width="16" height="16"><use href="#icon-upload"></use></svg>
                    <span id="file-name"></span>
                </div>
            </div>
            <div class="checkbox-row">
                <input type="checkbox" id="id_available_for_non_users" name="available_for_non_users" style="width:18px;height:18px;">
                <label for="id_available_for_non_users" style="font-size:1rem;color:#245F3E;cursor:pointer;">Available for the public</label>
            </div>
            <div class="form-actions">
                <a href="{% url 'downloadable_dispatcher' %}" class="back-btn">Back</a>
                <button type="submit" class="submit-btn" id="submit-btn">Submit</button>
            </div>
        </form>
    </div>

<!-- SVG Sprite Section -->
<svg style="display:none;">
    <!-- Upload Icon -->
    <symbol id="icon-upload" viewBox="0 0 24 24" fill="currentColor">
        <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z" />
        <path d="M12,11L8,15H16L12,11Z" />
    </symbol>
</svg>

<script>
    // File Input Change Handler
    document.getElementById('id_file').addEventListener('change', function(e) {
        const file = e.target.files[0];
        if (file) {
            document.getElementById('file-name').textContent = file.name;
            document.getElementById('file-preview').style.display = 'block';
            document.getElementById('file-error').style.display = 'none';
        } else {
            document.getElementById('file-preview').style.display = 'none';
        }
    });

    // Form Validation
    document.getElementById('downloadable-form').addEventListener('submit', function(e) {
        let valid = true;
        const fileInput = document.getElementById('id_file');
        const fileError = document.getElementById('file-error');
        if (!fileInput.files || fileInput.files.length === 0) {
            fileError.style.display = 'block';
            valid = false;
        } else {
            fileError.style.display = 'none';
        }

        if (!valid) {
            e.preventDefault();
        }
    });
</script>

</body>
</html>

{% endblock %}